<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compressor Analysis Tool</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <!-- CoolProp.js from local WASM files -->
    <script>
        // Set the WebAssembly module location path and callbacks
        var Module = {
            locateFile: function(path) {
                if(path.endsWith('.wasm')) {
                    return 'coolprop/' + path;
                }
                return path;
            },
            onRuntimeInitialized: function() {
                console.log("CoolProp WASM module initialized");
            },
            print: function(text) {
                console.log("CoolProp stdout:", text);
            },
            printErr: function(text) {
                console.error("CoolProp stderr:", text);
            }
        };
    </script>
    <script src="coolprop/coolprop.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Air Compressor Analysis Tool</h1>
            <p>Analyze compressor power consumption and energy savings at different suction temperatures</p>
        </header>
        
        <div class="main-content">
            <div class="input-panel">
                <h2>Input Parameters</h2>
                
                <form id="compressorForm">
                    <div class="form-group">
                        <label for="p_in">Suction Pressure (bar):</label>
                        <input type="number" id="p_in" value="1.0" step="0.1">
                    </div>
                    
                    <div class="form-group">
                        <label for="p_out">Discharge Pressure (bar):</label>
                        <input type="number" id="p_out" value="7.0" step="0.1">
                    </div>
                    
                    <div class="form-group">
                        <label for="mass_flow_rate">Flow Rate (CFM):</label>
                        <input type="number" id="mass_flow_rate" value="100" step="1">
                    </div>
                    
                    <div class="form-group">
                        <label for="efficiency">Compressor Efficiency (0-1):</label>
                        <input type="number" id="efficiency" value="0.9" min="0" max="1" step="0.01">
                    </div>
                    
                    <div class="form-group">
                        <label for="temp_min">Min Temperature (°C):</label>
                        <input type="number" id="temp_min" value="10" step="1">
                    </div>
                    
                    <div class="form-group">
                        <label for="temp_max">Max Temperature (°C):</label>
                        <input type="number" id="temp_max" value="40" step="1">
                    </div>
                    
                    <div class="form-group">
                        <label for="temp_ref">Reference Temperature (°C):</label>
                        <input type="number" id="temp_ref" value="35" step="1">
                    </div>
                    
                    <div class="form-group">
                        <label for="fluid">Working Fluid:</label>
                        <select id="fluid">
                            <option value="Air">Air</option>
                            <option value="Nitrogen">Nitrogen</option>
                            <option value="Oxygen">Oxygen</option>
                            <option value="CarbonDioxide">Carbon Dioxide</option>
                        </select>
                    </div>
                    
                    <button type="button" id="calculate">Calculate</button>
                </form>
            </div>
            
            <div class="results-panel">
                <h2>Results</h2>
                <div id="plotDiv"></div>
                
                <div class="summary-box">
                    <h3>Power Savings Summary</h3>
                    <div id="summaryResults">
                        <p>Enter parameters and click Calculate to see results.</p>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Built with CoolProp.js and Plotly.js | © 2025</p>
        </footer>
    </div>
    
    <script src="script.js"></script>
</body>
</html>
